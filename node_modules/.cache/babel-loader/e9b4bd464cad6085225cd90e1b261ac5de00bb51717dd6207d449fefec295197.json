{"ast":null,"code":"import _regeneratorRuntime from\"/home/zyad/Documents/active_projects/SalamApp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/zyad/Documents/active_projects/SalamApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/zyad/Documents/active_projects/SalamApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useCallback}from\"react\";import API_ID from\"../global/api\";import useLoacalStorage from\"./useLocalStorage\";import{useToast}from'@chakra-ui/react';var useFetch=function useFetch(_ref){var _ref$link=_ref.link,link=_ref$link===void 0?\"\":_ref$link,fetchOnFirstRun=_ref.fetchOnFirstRun,refreshTimeout=_ref.refreshTimeout,params=_ref.params,_ref$noAuthorization=_ref.noAuthorization,noAuthorization=_ref$noAuthorization===void 0?false:_ref$noAuthorization;var toast=useToast();var _useLoacalStorage=useLoacalStorage(),authorization=_useLoacalStorage.authorization;//@ts-ignore\nvar url=\"http://144.24.209.19:9090/api/v1/\".concat(API_ID[link]);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var getData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,apiData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(authorization||noAuthorization)){_context.next=8;break;}_context.next=3;return fetch(\"\".concat(url,\"?authorization=\").concat(authorization,\"&\").concat(new URLSearchParams(params)));case 3:response=_context.sent;_context.next=6;return response.json();case 6:apiData=_context.sent;setData(apiData);case 8:case\"end\":return _context.stop();}}},_callee);})),[authorization,noAuthorization,params,url]);useEffect(function(){if(fetchOnFirstRun){getData();}},[fetchOnFirstRun,getData,url,params]);useEffect(function(){if(data.response){toast({position:\"top-right\",title:'error',description:\"\".concat(JSON.stringify(data.response)),status:'error',duration:5000,isClosable:true});}},[data,toast]);var runFetch=useCallback(function(){getData();},[getData]);return{data:data,runFetch:runFetch,setData:setData};};export default useFetch;","map":{"version":3,"names":["useState","useEffect","useCallback","API_ID","useLoacalStorage","useToast","useFetch","link","fetchOnFirstRun","refreshTimeout","params","noAuthorization","toast","authorization","url","data","setData","getData","fetch","URLSearchParams","response","json","apiData","position","title","description","JSON","stringify","status","duration","isClosable","runFetch"],"sources":["/home/zyad/Documents/active_projects/SalamApp/src/hooks/useFetch.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\r\nimport API_ID from \"../global/api\";\r\nimport useLoacalStorage from \"./useLocalStorage\";\r\nimport { useToast } from '@chakra-ui/react';\r\n\r\ninterface useFetchProp {\r\n  link: string;\r\n  fetchOnFirstRun?: boolean;\r\n  refreshTimeout?: number;\r\n  params?: any\r\n  noAuthorization?: boolean\r\n}\r\n\r\nconst useFetch = ({\r\n    link = \"\", \r\n    fetchOnFirstRun,\r\n    refreshTimeout,\r\n    params, \r\n    noAuthorization = false\r\n  }: useFetchProp) => {\r\n    const toast = useToast()\r\n  const { authorization } = useLoacalStorage()\r\n  //@ts-ignore\r\n  const url = `http://144.24.209.19:9090/api/v1/${API_ID[link]}`\r\n  const [data, setData] = useState<any>([]);\r\n  const getData = useCallback(async()=>{\r\n    if(authorization || noAuthorization){\r\nconst response = await fetch(`${url}?authorization=${authorization}&${new URLSearchParams(params)}`)\r\n    const apiData=await response.json();  \r\n  setData(apiData);\r\n    }\r\n},[authorization, noAuthorization, params, url])\r\n\r\n\r\n    useEffect(() => {\r\n      if(fetchOnFirstRun){\r\n        getData()\r\n      }\r\n      }, [fetchOnFirstRun, getData, url, params]);\r\n\r\n      useEffect(()=>{\r\n        if (data.response){\r\n          toast({\r\n            position: \"top-right\",\r\n            title: 'error',\r\n            description: `${JSON.stringify(data.response)}`,\r\n            status: 'error',\r\n            duration: 5000,\r\n            isClosable: true,\r\n        })\r\n        }\r\n      }, [data, toast])\r\n\r\n\r\n\r\n      const runFetch = useCallback(()=>{\r\n          getData()\r\n      },[getData])\r\n\r\n      return{data, runFetch, setData}\r\n}\r\n\r\nexport default useFetch"],"mappings":"yZAAA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CACxD,MAAOC,OAAM,KAAM,eAAe,CAClC,MAAOC,iBAAgB,KAAM,mBAAmB,CAChD,OAASC,QAAQ,KAAQ,kBAAkB,CAU3C,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,MAMQ,oBALlBC,IAAI,CAAJA,IAAI,oBAAG,EAAE,WACTC,eAAe,MAAfA,eAAe,CACfC,cAAc,MAAdA,cAAc,CACdC,MAAM,MAANA,MAAM,2BACNC,eAAe,CAAfA,eAAe,+BAAG,KAAK,sBAEvB,GAAMC,MAAK,CAAGP,QAAQ,EAAE,CAC1B,sBAA0BD,gBAAgB,EAAE,CAApCS,aAAa,mBAAbA,aAAa,CACrB;AACA,GAAMC,IAAG,4CAAuCX,MAAM,CAACI,IAAI,CAAC,CAAE,CAC9D,cAAwBP,QAAQ,CAAM,EAAE,CAAC,wCAAlCe,IAAI,eAAEC,OAAO,eACpB,GAAMC,QAAO,CAAGf,WAAW,wEAAC,+JACvBW,aAAa,EAAIF,eAAe,gDAChBO,MAAK,WAAIJ,GAAG,2BAAkBD,aAAa,aAAI,GAAIM,gBAAe,CAACT,MAAM,CAAC,EAAG,QAA9FU,QAAQ,qCACUA,SAAQ,CAACC,IAAI,EAAE,QAA7BC,OAAO,eACfN,OAAO,CAACM,OAAO,CAAC,CAAC,sDAElB,GAAC,CAACT,aAAa,CAAEF,eAAe,CAAED,MAAM,CAAEI,GAAG,CAAC,CAAC,CAG5Cb,SAAS,CAAC,UAAM,CACd,GAAGO,eAAe,CAAC,CACjBS,OAAO,EAAE,CACX,CACA,CAAC,CAAE,CAACT,eAAe,CAAES,OAAO,CAAEH,GAAG,CAAEJ,MAAM,CAAC,CAAC,CAE3CT,SAAS,CAAC,UAAI,CACZ,GAAIc,IAAI,CAACK,QAAQ,CAAC,CAChBR,KAAK,CAAC,CACJW,QAAQ,CAAE,WAAW,CACrBC,KAAK,CAAE,OAAO,CACdC,WAAW,WAAKC,IAAI,CAACC,SAAS,CAACZ,IAAI,CAACK,QAAQ,CAAC,CAAE,CAC/CQ,MAAM,CAAE,OAAO,CACfC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAChB,CAAC,CAAC,CACF,CACF,CAAC,CAAE,CAACf,IAAI,CAAEH,KAAK,CAAC,CAAC,CAIjB,GAAMmB,SAAQ,CAAG7B,WAAW,CAAC,UAAI,CAC7Be,OAAO,EAAE,CACb,CAAC,CAAC,CAACA,OAAO,CAAC,CAAC,CAEZ,MAAM,CAACF,IAAI,CAAJA,IAAI,CAAEgB,QAAQ,CAARA,QAAQ,CAAEf,OAAO,CAAPA,OAAO,CAAC,CACrC,CAAC,CAED,cAAeV,SAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}