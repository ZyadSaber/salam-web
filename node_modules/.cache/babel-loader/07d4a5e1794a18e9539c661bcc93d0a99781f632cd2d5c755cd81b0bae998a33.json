{"ast":null,"code":"import _regeneratorRuntime from\"/home/zyad/Documents/active_projects/SalamApp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/zyad/Documents/active_projects/SalamApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/zyad/Documents/active_projects/SalamApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useCallback}from\"react\";import useLoacalStorage from\"./useLocalStorage\";import API_ID from\"../global/api\";import{useToast}from'@chakra-ui/react';;var usePost=function usePost(_ref){var _ref$link=_ref.link,link=_ref$link===void 0?\"\":_ref$link,_ref$noAuthorization=_ref.noAuthorization,noAuthorization=_ref$noAuthorization===void 0?false:_ref$noAuthorization;var toast=useToast();//@ts-ignore\nvar url=\"http://144.24.209.19:9090/api/v1/\".concat(API_ID[link]);var _useState=useState(),_useState2=_slicedToArray(_useState,2),success=_useState2[0],setSuccess=_useState2[1];var _useLoacalStorage=useLoacalStorage(),authorization=_useLoacalStorage.authorization;var postData=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dataToPost){var settings,fetchResponse,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(authorization||noAuthorization)){_context.next=18;break;}dataToPost.authorization=authorization;settings={method:'POST',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify(dataToPost)};_context.prev=3;_context.next=6;return fetch(url,settings);case 6:fetchResponse=_context.sent;_context.next=9;return fetchResponse.json();case 9:data=_context.sent;if(data.response===\"success\"){toast({position:\"top-right\",title:'Success',description:\"\".concat(data.response),status:'success',duration:5000,isClosable:true});}else{toast({position:\"top-right\",title:'Error',description:\"\".concat(data.response),status:'error',duration:9000,isClosable:true});}setSuccess(data);return _context.abrupt(\"return\",data);case 15:_context.prev=15;_context.t0=_context[\"catch\"](3);console.log(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[3,15]]);}));return function(_x){return _ref2.apply(this,arguments);};}(),[authorization,noAuthorization,toast,url]);var setRow=useCallback(function(row){postData(row);},[postData]);return{success:success,setRow:setRow};};export default usePost;","map":{"version":3,"names":["useState","useCallback","useLoacalStorage","API_ID","useToast","usePost","link","noAuthorization","toast","url","success","setSuccess","authorization","postData","dataToPost","settings","method","headers","Accept","body","JSON","stringify","fetch","fetchResponse","json","data","response","position","title","description","status","duration","isClosable","console","log","setRow","row"],"sources":["/home/zyad/Documents/active_projects/SalamApp/src/hooks/usePost.ts"],"sourcesContent":["import { useState, useCallback } from \"react\";\r\nimport useLoacalStorage from \"./useLocalStorage\";\r\nimport API_ID from \"../global/api\";\r\nimport { useToast } from '@chakra-ui/react';\r\n\r\ninterface usePostProps{\r\n    link: string;\r\n    noAuthorization?: boolean\r\n};\r\ninterface successType{\r\n    response: string;\r\n}\r\n\r\nconst usePost = ({\r\n    link  = \"\",\r\n    noAuthorization = false\r\n}: usePostProps) => {\r\n    const toast = useToast()\r\n    //@ts-ignore\r\n    const url = `http://144.24.209.19:9090/api/v1/${API_ID[link]}`\r\n    const [success, setSuccess] = useState<successType>()\r\n    const { authorization } = useLoacalStorage()\r\n    const postData = useCallback(async (dataToPost: any) => {\r\n        if(authorization || noAuthorization){\r\n        dataToPost.authorization = authorization\r\n        const settings = {\r\n            method: 'POST',\r\n            headers: {\r\n                Accept: 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(dataToPost)\r\n        };\r\n        try {\r\n            const fetchResponse = await fetch(url, settings);\r\n            const data = await fetchResponse.json();\r\n            if (data.response === \"success\"){\r\n            toast({\r\n            position: \"top-right\",\r\n            title: 'Success',\r\n            description: `${data.response}`,\r\n            status: 'success',\r\n            duration: 5000,\r\n            isClosable: true,\r\n        })\r\n            } else {\r\n                toast({\r\n            position: \"top-right\",\r\n            title: 'Error',\r\n            description: `${data.response}`,\r\n            status: 'error',\r\n            duration: 9000,\r\n            isClosable: true,\r\n        })\r\n            }\r\n            setSuccess(data)\r\n            return data\r\n        } catch (e) {\r\n            console.log(e)\r\n        }}\r\n    }, [authorization, noAuthorization, toast, url])\r\n\r\n    const setRow = useCallback((row: any) => {\r\n        postData(row)\r\n    }, [postData])\r\n\r\n    return { success, setRow }\r\n}\r\n\r\nexport default usePost"],"mappings":"yZAAA,OAASA,QAAQ,CAAEC,WAAW,KAAQ,OAAO,CAC7C,MAAOC,iBAAgB,KAAM,mBAAmB,CAChD,MAAOC,OAAM,KAAM,eAAe,CAClC,OAASC,QAAQ,KAAQ,kBAAkB,CAK1C,CAKD,GAAMC,QAAO,CAAG,QAAVA,QAAO,MAGO,oBAFhBC,IAAI,CAAJA,IAAI,oBAAI,EAAE,qCACVC,eAAe,CAAfA,eAAe,+BAAG,KAAK,sBAEvB,GAAMC,MAAK,CAAGJ,QAAQ,EAAE,CACxB;AACA,GAAMK,IAAG,4CAAuCN,MAAM,CAACG,IAAI,CAAC,CAAE,CAC9D,cAA8BN,QAAQ,EAAe,wCAA9CU,OAAO,eAAEC,UAAU,eAC1B,sBAA0BT,gBAAgB,EAAE,CAApCU,aAAa,mBAAbA,aAAa,CACrB,GAAMC,SAAQ,CAAGZ,WAAW,6FAAC,iBAAOa,UAAe,yJAC5CF,aAAa,EAAIL,eAAe,2BACnCO,UAAU,CAACF,aAAa,CAAGA,aAAa,CAClCG,QAAQ,CAAG,CACbC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACLC,MAAM,CAAE,kBAAkB,CAC1B,cAAc,CAAE,kBACpB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACP,UAAU,CACnC,CAAC,uCAE+BQ,MAAK,CAACb,GAAG,CAAEM,QAAQ,CAAC,QAA1CQ,aAAa,qCACAA,cAAa,CAACC,IAAI,EAAE,QAAjCC,IAAI,eACV,GAAIA,IAAI,CAACC,QAAQ,GAAK,SAAS,CAAC,CAChClB,KAAK,CAAC,CACNmB,QAAQ,CAAE,WAAW,CACrBC,KAAK,CAAE,SAAS,CAChBC,WAAW,WAAKJ,IAAI,CAACC,QAAQ,CAAE,CAC/BI,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAChB,CAAC,CAAC,CACE,CAAC,IAAM,CACHxB,KAAK,CAAC,CACVmB,QAAQ,CAAE,WAAW,CACrBC,KAAK,CAAE,OAAO,CACdC,WAAW,WAAKJ,IAAI,CAACC,QAAQ,CAAE,CAC/BI,MAAM,CAAE,OAAO,CACfC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAChB,CAAC,CAAC,CACE,CACArB,UAAU,CAACc,IAAI,CAAC,iCACTA,IAAI,4DAEXQ,OAAO,CAACC,GAAG,aAAG,sEAErB,gEAAE,CAACtB,aAAa,CAAEL,eAAe,CAAEC,KAAK,CAAEC,GAAG,CAAC,CAAC,CAEhD,GAAM0B,OAAM,CAAGlC,WAAW,CAAC,SAACmC,GAAQ,CAAK,CACrCvB,QAAQ,CAACuB,GAAG,CAAC,CACjB,CAAC,CAAE,CAACvB,QAAQ,CAAC,CAAC,CAEd,MAAO,CAAEH,OAAO,CAAPA,OAAO,CAAEyB,MAAM,CAANA,MAAO,CAAC,CAC9B,CAAC,CAED,cAAe9B,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}