{"ast":null,"code":"import _objectSpread from\"/home/zyad/Documents/ActiveProjects/SalamApp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/zyad/Documents/ActiveProjects/SalamApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{memo,useState,useCallback}from\"react\";import Table from\"./Table\";import useFetch from\"../../hooks/useFetch\";import useTableControlsButtons from\"./hooks/useTableControlsButtons\";import Notification from\"../Notification/component\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ApiTable=function ApiTable(_ref){var api=_ref.api,postApi=_ref.postApi,columns=_ref.columns,hideTools=_ref.hideTools,canAdd=_ref.canAdd,canEdit=_ref.canEdit,canDelete=_ref.canDelete,rowKey=_ref.rowKey,Modal=_ref.Modal,width=_ref.width,onSelectedRow=_ref.onSelectedRow,_ref$fetchOnFirstRun=_ref.fetchOnFirstRun,fetchOnFirstRun=_ref$fetchOnFirstRun===void 0?false:_ref$fetchOnFirstRun,params=_ref.params;var _useFetch=useFetch({link:api,fetchOnFirstRun:fetchOnFirstRun,params:params}),data=_useFetch.data,refresh=_useFetch.refresh;var _useTableControlsButt=useTableControlsButtons(postApi),setSelectedRow=_useTableControlsButt.setSelectedRow,onSaveAndInsertion=_useTableControlsButt.onSaveAndInsertion,selectedRow=_useTableControlsButt.selectedRow,success=_useTableControlsButt.success;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),rows=_useState2[0],setRows=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),modal=_useState4[0],setModal=_useState4[1];var handleAdd=useCallback(function(){setSelectedRow({query_status:\"n\"});setModal(true);},[setSelectedRow]);var handleEdit=useCallback(function(){setSelectedRow(_objectSpread(_objectSpread({},rows),{},{query_status:\"u\"}));setModal(true);},[rows,setSelectedRow]);var handleDelete=function handleDelete(){setSelectedRow(_objectSpread(_objectSpread({},rows),{},{query_status:\"d\"}));onSaveAndInsertion();};var handleCloseModal=useCallback(function(){setModal(false);},[]);var handleSaveModal=useCallback(function(){setModal(false);onSaveAndInsertion();refresh();},[onSaveAndInsertion,refresh]);var handleSelectedRow=function handleSelectedRow(row){setRows(row);if(onSelectedRow)onSelectedRow(row);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Notification,{Label:\"Alert\",body:success}),Modal&&/*#__PURE__*/_jsx(Modal,{visible:modal,onOK:handleSaveModal,onClose:handleCloseModal,selectedRow:selectedRow,setSelectedRow:setSelectedRow}),/*#__PURE__*/_jsx(Table,{dataSource:data,columns:columns,hideTools:hideTools,canAdd:canAdd,canEdit:canEdit,canDelete:canDelete,rowkey:rowKey,onAdd:handleAdd,onEdit:handleEdit,onDelete:handleDelete,onSelectedRow:handleSelectedRow,width:width})]});};export default/*#__PURE__*/memo(ApiTable);","map":{"version":3,"names":["memo","useState","useCallback","Table","useFetch","useTableControlsButtons","Notification","ApiTable","api","postApi","columns","hideTools","canAdd","canEdit","canDelete","rowKey","Modal","width","onSelectedRow","fetchOnFirstRun","params","link","data","refresh","setSelectedRow","onSaveAndInsertion","selectedRow","success","rows","setRows","modal","setModal","handleAdd","query_status","handleEdit","handleDelete","handleCloseModal","handleSaveModal","handleSelectedRow","row"],"sources":["/home/zyad/Documents/ActiveProjects/SalamApp/src/components/TableView/ApiTable.tsx"],"sourcesContent":["import { memo, useState, useCallback } from \"react\";\r\nimport Table from \"./Table\";\r\nimport useFetch from \"../../hooks/useFetch\";\r\nimport useTableControlsButtons from \"./hooks/useTableControlsButtons\"\r\nimport Notification from \"../Notification/component\";\r\n\r\ninterface ApiTableProps {\r\n    api: string;\r\n    postApi?: string;\r\n    columns: {\r\n        title: string,\r\n        dataIndex: string,\r\n        width: number | string\r\n    }[];\r\n    hideTools?: boolean;\r\n    canAdd?: boolean;\r\n    canEdit?: boolean;\r\n    canDelete?: boolean;\r\n    rowKey: string;\r\n    Modal?: any;\r\n    width?: number | string;\r\n    onSelectedRow?: any;\r\n    fetchOnFirstRun?: boolean;\r\n    refreshAfter?: number;\r\n    params?: any;\r\n}\r\n\r\nconst ApiTable = ({\r\n    api,\r\n    postApi,\r\n    columns,\r\n    hideTools,\r\n    canAdd,\r\n    canEdit,\r\n    canDelete,\r\n    rowKey,\r\n    Modal,\r\n    width,\r\n    onSelectedRow,\r\n    fetchOnFirstRun = false,\r\n    params\r\n}: ApiTableProps) => {\r\n\r\n    const { data, refresh } = useFetch({ link: api, fetchOnFirstRun: fetchOnFirstRun, params: params })\r\n    const { setSelectedRow, onSaveAndInsertion, selectedRow, success } = useTableControlsButtons(postApi)\r\n    const [rows, setRows] = useState({})\r\n    const [modal, setModal] = useState(false)\r\n    const handleAdd = useCallback(() => {\r\n        setSelectedRow({ query_status: \"n\" })\r\n        setModal(true)\r\n    }, [setSelectedRow])\r\n    const handleEdit = useCallback(() => {\r\n        setSelectedRow({ ...rows, query_status: \"u\" })\r\n        setModal(true)\r\n    }, [rows, setSelectedRow])\r\n    const handleDelete = () => {\r\n        setSelectedRow({ ...rows, query_status: \"d\" })\r\n        onSaveAndInsertion()\r\n    }\r\n\r\n    const handleCloseModal = useCallback(() => {\r\n        setModal(false)\r\n    }, [])\r\n\r\n    const handleSaveModal = useCallback(() => {\r\n        setModal(false)\r\n        onSaveAndInsertion()\r\n        refresh()\r\n    }, [onSaveAndInsertion, refresh])\r\n\r\n    const handleSelectedRow = (row: any) => {\r\n        setRows(row)\r\n        if (onSelectedRow) onSelectedRow(row)\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Notification\r\n                Label=\"Alert\"\r\n                body={success}\r\n            />\r\n            {Modal && <Modal\r\n                visible={modal}\r\n                onOK={handleSaveModal}\r\n                onClose={handleCloseModal}\r\n                selectedRow={selectedRow}\r\n                setSelectedRow={setSelectedRow}\r\n            />}\r\n            <Table\r\n                dataSource={data}\r\n                columns={columns}\r\n                hideTools={hideTools}\r\n                canAdd={canAdd}\r\n                canEdit={canEdit}\r\n                canDelete={canDelete}\r\n                rowkey={rowKey}\r\n                onAdd={handleAdd}\r\n                onEdit={handleEdit}\r\n                onDelete={handleDelete}\r\n                onSelectedRow={handleSelectedRow}\r\n                width={width}\r\n            >\r\n            </Table>\r\n\r\n        </>\r\n    )\r\n}\r\n\r\nexport default memo(ApiTable)"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}