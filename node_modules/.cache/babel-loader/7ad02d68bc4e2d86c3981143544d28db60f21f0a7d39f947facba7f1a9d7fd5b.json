{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from \"react\";\nimport { API_ID } from \"@commons/global\";\nimport { useLocalStorage } from \"@commons/hooks\";\nimport { useToast } from '@chakra-ui/react';\nconst useFetch = _ref => {\n  _s();\n  let {\n    link = \"\",\n    fetchOnFirstRun,\n    refreshTimeout,\n    params,\n    noAuthorization = false\n  } = _ref;\n  const toast = useToast();\n  const {\n    authorization\n  } = useLocalStorage();\n  //@ts-ignore\n  const url = `http://144.24.209.19:9090/api/v1/${API_ID[link]}`;\n  const [data, setData] = useState([]);\n  const getData = useCallback(async () => {\n    if (authorization || noAuthorization) {\n      const response = await fetch(`${url}?authorization=${authorization}&${new URLSearchParams(params)}`);\n      const apiData = await response.json();\n      setData(apiData);\n    }\n  }, [authorization, noAuthorization, params, url]);\n  useEffect(() => {\n    if (fetchOnFirstRun) {\n      getData();\n    }\n  }, [fetchOnFirstRun, getData, url, params]);\n  useEffect(() => {\n    if (data.response) {\n      toast({\n        position: \"top-right\",\n        title: 'error',\n        description: `${JSON.stringify(data.response)}`,\n        status: 'error',\n        duration: 5000,\n        isClosable: true\n      });\n    }\n  }, [data, toast]);\n  const runFetch = useCallback(() => {\n    getData();\n  }, [getData]);\n  return {\n    data,\n    runFetch,\n    setData\n  };\n};\n_s(useFetch, \"rlk6kQz9OcNKHsa6dRn74rQCMRQ=\", false, function () {\n  return [useToast, useLocalStorage];\n});\nexport default useFetch;","map":{"version":3,"names":["useState","useEffect","useCallback","API_ID","useLocalStorage","useToast","useFetch","link","fetchOnFirstRun","refreshTimeout","params","noAuthorization","toast","authorization","url","data","setData","getData","response","fetch","URLSearchParams","apiData","json","position","title","description","JSON","stringify","status","duration","isClosable","runFetch"],"sources":["/home/zyad/Documents/active_projects/SalamApp/common/hooks/src/useFetch.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\r\nimport {API_ID} from \"@commons/global\";\r\nimport { useLocalStorage } from \"@commons/hooks\"\r\nimport { useToast } from '@chakra-ui/react';\r\n\r\ninterface useFetchProp {\r\n  link: string;\r\n  fetchOnFirstRun?: boolean;\r\n  refreshTimeout?: number;\r\n  params?: any\r\n  noAuthorization?: boolean\r\n}\r\n\r\nconst useFetch = ({\r\n    link = \"\", \r\n    fetchOnFirstRun,\r\n    refreshTimeout,\r\n    params, \r\n    noAuthorization = false\r\n  }: useFetchProp) => {\r\n    const toast = useToast()\r\n  const { authorization } = useLocalStorage()\r\n  //@ts-ignore\r\n  const url = `http://144.24.209.19:9090/api/v1/${API_ID[link]}`\r\n  const [data, setData] = useState<any>([]);\r\n  const getData = useCallback(async()=>{\r\n    if(authorization || noAuthorization){\r\nconst response = await fetch(`${url}?authorization=${authorization}&${new URLSearchParams(params)}`)\r\n    const apiData=await response.json();  \r\n  setData(apiData);\r\n    }\r\n},[authorization, noAuthorization, params, url])\r\n\r\n\r\n    useEffect(() => {\r\n      if(fetchOnFirstRun){\r\n        getData()\r\n      }\r\n      }, [fetchOnFirstRun, getData, url, params]);\r\n\r\n      useEffect(()=>{\r\n        if (data.response){\r\n          toast({\r\n            position: \"top-right\",\r\n            title: 'error',\r\n            description: `${JSON.stringify(data.response)}`,\r\n            status: 'error',\r\n            duration: 5000,\r\n            isClosable: true,\r\n        })\r\n        }\r\n      }, [data, toast])\r\n\r\n\r\n\r\n      const runFetch = useCallback(()=>{\r\n          getData()\r\n      },[getData])\r\n\r\n      return{data, runFetch, setData}\r\n}\r\n\r\nexport default useFetch"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AACxD,SAAQC,MAAM,QAAO,iBAAiB;AACtC,SAASC,eAAe,QAAQ,gBAAgB;AAChD,SAASC,QAAQ,QAAQ,kBAAkB;AAU3C,MAAMC,QAAQ,GAAG,QAMK;EAAA;EAAA,IANJ;IACdC,IAAI,GAAG,EAAE;IACTC,eAAe;IACfC,cAAc;IACdC,MAAM;IACNC,eAAe,GAAG;EACN,CAAC;EACb,MAAMC,KAAK,GAAGP,QAAQ,EAAE;EAC1B,MAAM;IAAEQ;EAAc,CAAC,GAAGT,eAAe,EAAE;EAC3C;EACA,MAAMU,GAAG,GAAI,oCAAmCX,MAAM,CAACI,IAAI,CAAE,EAAC;EAC9D,MAAM,CAACQ,IAAI,EAAEC,OAAO,CAAC,GAAGhB,QAAQ,CAAM,EAAE,CAAC;EACzC,MAAMiB,OAAO,GAAGf,WAAW,CAAC,YAAS;IACnC,IAAGW,aAAa,IAAIF,eAAe,EAAC;MACxC,MAAMO,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEL,GAAI,kBAAiBD,aAAc,IAAG,IAAIO,eAAe,CAACV,MAAM,CAAE,EAAC,CAAC;MAChG,MAAMW,OAAO,GAAC,MAAMH,QAAQ,CAACI,IAAI,EAAE;MACrCN,OAAO,CAACK,OAAO,CAAC;IACd;EACJ,CAAC,EAAC,CAACR,aAAa,EAAEF,eAAe,EAAED,MAAM,EAAEI,GAAG,CAAC,CAAC;EAG5Cb,SAAS,CAAC,MAAM;IACd,IAAGO,eAAe,EAAC;MACjBS,OAAO,EAAE;IACX;EACA,CAAC,EAAE,CAACT,eAAe,EAAES,OAAO,EAAEH,GAAG,EAAEJ,MAAM,CAAC,CAAC;EAE3CT,SAAS,CAAC,MAAI;IACZ,IAAIc,IAAI,CAACG,QAAQ,EAAC;MAChBN,KAAK,CAAC;QACJW,QAAQ,EAAE,WAAW;QACrBC,KAAK,EAAE,OAAO;QACdC,WAAW,EAAG,GAAEC,IAAI,CAACC,SAAS,CAACZ,IAAI,CAACG,QAAQ,CAAE,EAAC;QAC/CU,MAAM,EAAE,OAAO;QACfC,QAAQ,EAAE,IAAI;QACdC,UAAU,EAAE;MAChB,CAAC,CAAC;IACF;EACF,CAAC,EAAE,CAACf,IAAI,EAAEH,KAAK,CAAC,CAAC;EAIjB,MAAMmB,QAAQ,GAAG7B,WAAW,CAAC,MAAI;IAC7Be,OAAO,EAAE;EACb,CAAC,EAAC,CAACA,OAAO,CAAC,CAAC;EAEZ,OAAM;IAACF,IAAI;IAAEgB,QAAQ;IAAEf;EAAO,CAAC;AACrC,CAAC;AAAA,GA/CKV,QAAQ;EAAA,QAOID,QAAQ,EACED,eAAe;AAAA;AAyC3C,eAAeE,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}